# 実験レポート

## 概要

- **背景:** 日本語の「青」は、物理的な緑色スペクトルの一部（信号機、野菜など）を包含する性質を持つ
- **RQ:** 言語データで学習されたVision-Language Models (VLMs) は、この言語的なねじれ（サピア・ウォーフ効果）を視覚認識において再現するか？すなわち、**日本語特化モデルは英語モデルに比べて、「緑色」を「青」と判定する確率が高いか？**
- **アプローチ:** HSV色空間上で制御された画像に対するモデルの応答曲線を計測。その曲線の形状を比較することで、日本語特化モデルが英語モデルに比べて、「緑色」を「青」と判定する確率が高いかどうかを検証する。

## 実験設計

### タスク定義とデータセット構築

- HSV 色空間上で制御された、2種類の画像 (タスク) に対するモデルの予測確率曲線を計測
   - タスク1: 色相を変化させた単色のカラーパッチ
     - 純粋に色に対する VLM の反応を検証
   - タスク2: 色相を変化させた実際の画像
     - 物体認識が色彩判定に与えるバイアスを検証
- 各プロンプトテンプレートの埋め込みベクトルと画像埋め込みのコサイン類似度を計算し、Softmax関数で確率化

### モデル選定

- 英語データのみで訓練されたモデル (en): `laion/CLIP-ViT-L-14-laion2B-s32B-b82K`
- 日本語データのみで訓練されたモデル…はないから、英語のモデルを日本語データで Fine-tuning したモデル (ja): `llm-jp/llm-jp-clip-vit-large-patch14`
- 多言語データで訓練されたモデル (mul): `timm/ViT-SO400M-14-SigLIP-384`

公平な比較を期するため、なるべく同じベースモデル・パラメータサイズ、パッチサイズのモデルを使用

### プロンプト

#### タスク1

- 英語: `["green color", "blue color"]`
- 日本語: `["緑色", "青色"]`

#### タスク2

| 物体          | 英語プロンプト <br> (green/blue)                                   | 日本語プロンプト <br> (緑色/青色)                      |
|--------------|--------------------------------------------------------------------|--------------------------------------------------|
| 信号機        | the color of illuminated circle light is green/blue | 光っている丸いライトの色は緑色/青色  |
| リンゴ        | the color of the apple is green/blue | このリンゴの色は緑色/青色                |
| 野菜          | the color of the vegetables is green/blue | この野菜の色は緑色/青色                    |
| グラスの液体  | the color of the liquid in the glass is green/blue | グラスに入った汁の色は緑色/青色        |

### 評価指標

閾値を 0.5 として、青色の確率が 0.5 を超えたら青色、そうでなければ緑色と判定する。
閾値が 0.5 を初めて超えた色相角 $PSE = \{ h \mid P(\text{Blue}|h) = 0.5 \}$ を求め、

## データ作成

### タスク1

- 明度 (V) と 彩度 (S) を固定し、色相角 (H) のみを変化させた単色パッチ。
- $H \in [120^\circ, 240^\circ]$ (Green $\to$ Blue) で $1^\circ$ 刻み (計121枚)
- $V=100$ で固定、$S={10, 20, 30, 40, 50, 60, 70, 80, 90, 100}$ でグリッドサーチ
- $256 \times 256$ px

![](./assets/task1_data_color_patches.png)
*作成されたカラーパッチ*

![](./assets/task1_data_color_wheel.png)
*全カラーパッチをカラーホイールにプロット*

### タスク2

- 4 枚の写真（青信号、青菜、青リンゴ、青汁）を用意し、それぞれの緑色部分に対して色相回転を適用
  - これにより、「信号機」などの物体認識が色彩判定に与えるバイアスを検証
- 4 枚の写真それぞれに対して $1^\circ$ 刻み（計 $121$ 枚）の色相回転を適用

![](./assets/task2_data_images.png)
*作成された画像*

## 実験結果

### タスク1

![](./assets/task1_result_s100_laion_en_llmjp_ja.png)

$S=100$ の場合、
